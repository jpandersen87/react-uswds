{"version":3,"file":"InPageNavigation.js","sources":["../../../libSrc/components/InPageNavigation/InPageNavigation.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport classnames from 'classnames'\nimport type { HeadingLevel } from '../../types/headingLevel.js'\nimport Link from '../Link/Link.js'\n\nimport styles from './InPageNavigation.module.scss'\n\nexport type InPageNavigationProps = {\n  className?: string\n  content: JSX.Element\n  headingLevel?: HeadingLevel\n  mainProps?: JSX.IntrinsicElements['main']\n  navProps?: JSX.IntrinsicElements['nav']\n  rootMargin?: string\n  scrollOffset?: string\n  threshold?: number\n  title?: string\n} & Omit<JSX.IntrinsicElements['div'], 'content'>\n\nconst InPageNavigation = ({\n  className,\n  content,\n  headingLevel = 'h4',\n  mainProps,\n  navProps,\n  rootMargin = '0px 0px 0px 0px',\n  scrollOffset,\n  threshold = 1,\n  title = 'On this page',\n  ...divProps\n}: InPageNavigationProps): React.ReactElement => {\n  const classes = classnames('usa-in-page-nav', styles.target, className)\n  const { className: navClassName, ...remainingNavProps } = navProps || {}\n  const navClasses = classnames('usa-in-page-nav__nav', navClassName)\n  const { className: mainClassName, ...remainingMainProps } = mainProps || {}\n  const mainClasses = classnames('main-content', mainClassName)\n  const Heading = headingLevel\n  const offsetStyle = {\n    '--margin-offset': scrollOffset,\n  } as React.CSSProperties\n  const [currentSection, setCurrentSection] = useState('')\n  const sectionHeadings: JSX.Element[] = content.props.children.filter(\n    (el: JSX.Element) => el.type === 'h2' || el.type === 'h3'\n  )\n  const handleIntersection = (entries: IntersectionObserverEntry[]) => {\n    entries.forEach((entry) => {\n      if (entry.isIntersecting) {\n        setCurrentSection(entry.target.id)\n      }\n    })\n  }\n  const observerOptions = {\n    root: null,\n    rootMargin: rootMargin,\n    threshold: [threshold],\n  }\n  const observer = new IntersectionObserver(handleIntersection, observerOptions)\n  useEffect(() => {\n    document.querySelectorAll('h2,h3').forEach((h) => observer.observe(h))\n  })\n\n  return (\n    <div className=\"usa-in-page-nav-container\" {...divProps}>\n      <aside\n        className={classes}\n        aria-label={title}\n        data-testid=\"InPageNavigation\">\n        <nav className={navClasses} {...remainingNavProps}>\n          <Heading className=\"usa-in-page-nav__heading\" tabIndex={0}>\n            {title}\n          </Heading>\n          <ul className=\"usa-in-page-nav__list\">\n            {sectionHeadings.map((el: JSX.Element) => {\n              const heading: JSX.Element = el.props.children\n              const href: string = el.props.id\n              const hClass = classnames('usa-in-page-nav__item', {\n                'usa-in-page-nav__item--sub-item': el.type === 'h3',\n              })\n              const lClass = classnames('usa-in-page-nav__link', {\n                'usa-current': href === currentSection,\n              })\n              return (\n                <li key={`usa-in-page-nav__item_${heading}`} className={hClass}>\n                  <Link href={`#${href}`} className={lClass}>\n                    {heading}\n                  </Link>\n                </li>\n              )\n            })}\n          </ul>\n        </nav>\n      </aside>\n      <main\n        id=\"main-content\"\n        className={mainClasses}\n        {...remainingMainProps}\n        style={scrollOffset ? offsetStyle : undefined}>\n        {content}\n      </main>\n    </div>\n  )\n}\n\nexport default InPageNavigation\n"],"names":["InPageNavigation","className","content","headingLevel","mainProps","navProps","rootMargin","scrollOffset","threshold","title","divProps","classes","classnames","styles","navClassName","remainingNavProps","navClasses","mainClassName","remainingMainProps","mainClasses","Heading","offsetStyle","currentSection","setCurrentSection","useState","sectionHeadings","el","handleIntersection","entries","entry","observerOptions","observer","useEffect","h","jsxs","jsx","heading","href","hClass","lClass","Link"],"mappings":";;;;cAmBMA,IAAmB,CAAC;AAAA,EACxB,WAAAC;AAAA,EACA,SAAAC;AAAA,EACA,cAAAC,IAAe;AAAA,EACf,WAAAC;AAAA,EACA,UAAAC;AAAA,EACA,YAAAC,IAAa;AAAA,EACb,cAAAC;AAAA,EACA,WAAAC,IAAY;AAAA,EACZ,OAAAC,IAAQ;AAAA,EACR,GAAGC;AACL,MAAiD;AAC/C,QAAMC,IAAUC,EAAW,mBAAmBC,EAAO,QAAQZ,CAAS,GAChE,EAAE,WAAWa,GAAc,GAAGC,EAAkB,IAAIV,KAAY,IAChEW,IAAaJ,EAAW,wBAAwBE,CAAY,GAC5D,EAAE,WAAWG,GAAe,GAAGC,EAAmB,IAAId,KAAa,IACnEe,IAAcP,EAAW,gBAAgBK,CAAa,GACtDG,IAAUjB,GACVkB,IAAc;AAAA,IAClB,mBAAmBd;AAAA,EAAA,GAEf,CAACe,GAAgBC,CAAiB,IAAIC,EAAS,EAAE,GACjDC,IAAiCvB,EAAQ,MAAM,SAAS;AAAA,IAC5D,CAACwB,MAAoBA,EAAG,SAAS,QAAQA,EAAG,SAAS;AAAA,EAAA,GAEjDC,IAAqB,CAACC,MAAyC;AAC3D,IAAAA,EAAA,QAAQ,CAACC,MAAU;AACzB,MAAIA,EAAM,kBACUN,EAAAM,EAAM,OAAO,EAAE;AAAA,IACnC,CACD;AAAA,EAAA,GAEGC,IAAkB;AAAA,IACtB,MAAM;AAAA,IACN,YAAAxB;AAAA,IACA,WAAW,CAACE,CAAS;AAAA,EAAA,GAEjBuB,IAAW,IAAI,qBAAqBJ,GAAoBG,CAAe;AAC7E,SAAAE,EAAU,MAAM;AACL,aAAA,iBAAiB,OAAO,EAAE,QAAQ,CAACC,MAAMF,EAAS,QAAQE,CAAC,CAAC;AAAA,EAAA,CACtE,GAGE,gBAAAC,EAAA,OAAA,EAAI,WAAU,6BAA6B,GAAGxB,GAC7C,UAAA;AAAA,IAAA,gBAAAyB;AAAA,MAAC;AAAA,MAAA;AAAA,QACC,WAAWxB;AAAA,QACX,cAAYF;AAAA,QACZ,eAAY;AAAA,QACZ,UAAC,gBAAAyB,EAAA,OAAA,EAAI,WAAWlB,GAAa,GAAGD,GAC9B,UAAA;AAAA,UAAA,gBAAAoB,EAACf,GAAQ,EAAA,WAAU,4BAA2B,UAAU,GACrD,UACHX,GAAA;AAAA,4BACC,MAAG,EAAA,WAAU,yBACX,UAAgBgB,EAAA,IAAI,CAACC,MAAoB;AAClC,kBAAAU,IAAuBV,EAAG,MAAM,UAChCW,IAAeX,EAAG,MAAM,IACxBY,IAAS1B,EAAW,yBAAyB;AAAA,cACjD,mCAAmCc,EAAG,SAAS;AAAA,YAAA,CAChD,GACKa,IAAS3B,EAAW,yBAAyB;AAAA,cACjD,eAAeyB,MAASf;AAAA,YAAA,CACzB;AACD,qCACG,MAA4C,EAAA,WAAWgB,GACtD,UAAA,gBAAAH,EAACK,KAAK,MAAM,IAAIH,CAAI,IAAI,WAAWE,GAChC,UAAAH,EAAA,CACH,EAHO,GAAA,yBAAyBA,CAAO,EAIzC;AAAA,UAEH,CAAA,GACH;AAAA,QAAA,GACF;AAAA,MAAA;AAAA,IACF;AAAA,IACA,gBAAAD;AAAA,MAAC;AAAA,MAAA;AAAA,QACC,IAAG;AAAA,QACH,WAAWhB;AAAA,QACV,GAAGD;AAAA,QACJ,OAAOX,IAAec,IAAc;AAAA,QACnC,UAAAnB;AAAA,MAAA;AAAA,IACH;AAAA,EACF,EAAA,CAAA;AAEJ;"}